# 媒体文件下载说明

这个脚本用于从原始服务器下载所有媒体文件（mp3、mp4、图片等）并更新网页链接。

## 使用方法

### 1. 确保连接到特定网络

**重要**：原始服务器 `http://203.72.57.15` 只能在特定网络下访问。请确保你的电脑已连接到该网络。

### 2. 运行下载脚本

在项目目录下运行：

```bash
python3 download_media.py
```

或者：

```bash
python download_media.py
```

### 3. 脚本功能

脚本会：

1. **扫描文件**：扫描所有 HTML 文件和原始备份文件，提取所有媒体文件链接
2. **下载文件**：从服务器下载所有找到的媒体文件到 `media/` 目录
3. **更新链接**：自动更新所有 HTML 文件中的链接，指向本地文件

### 4. 下载的文件结构

下载的文件会保存在 `media/` 目录下，保持原始目录结构：

```
media/
├── wp-content/
│   └── uploads/
│       ├── 2018/
│       │   └── 04/
│       │       └── 女人香-錄音室版演奏.mp4
│       ├── 203/
│       │   ├── g1.mp3
│       │   ├── g2.mp3
│       │   └── ...
│       ├── 202/
│       │   ├── g1.mp3
│       │   └── ...
│       ├── 201/
│       │   ├── g1.mp3
│       │   └── ...
│       ├── ebook/
│       │   ├── 1.mp3
│       │   ├── 1c.mp3
│       │   ├── 1.gif
│       │   └── ...
│       ├── stdphoto/
│       │   ├── 7.jpg
│       │   ├── 8.jpg
│       │   └── ...
│       ├── yang.mp3
│       └── yang_program.mp3
```

### 5. 注意事项

- **网络连接**：确保在运行脚本时已连接到可以访问 `http://203.72.57.15` 的网络
- **文件已存在**：如果文件已下载过，脚本会跳过，不会重复下载
- **下载失败**：如果某些文件下载失败，脚本会继续下载其他文件，并在最后显示统计信息
- **备份建议**：运行脚本前建议备份 HTML 文件

### 6. 故障排除

如果遇到问题：

1. **连接错误**：检查网络连接，确保可以访问 `http://203.72.57.15`
2. **权限错误**：确保有写入权限
3. **编码错误**：确保系统支持 UTF-8 编码

### 7. 手动下载

如果某些文件自动下载失败，你可以：

1. 查看脚本输出的失败信息
2. 手动访问 URL 下载文件
3. 将文件放到对应的 `media/` 子目录中
4. 重新运行脚本更新链接（已存在的文件会被跳过）

## 更新后的链接格式

更新后，HTML 文件中的链接会从：

```html
<source src="http://203.72.57.15/blog_music/wp-content/uploads/yang.mp3" />
```

变为：

```html
<source src="media/wp-content/uploads/yang.mp3" />
```

这样网站就可以完全独立运行，不需要连接到原始服务器。

